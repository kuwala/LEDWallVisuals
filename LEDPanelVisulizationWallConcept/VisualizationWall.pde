class VisualizationWall {
  int scottBars;
  int northRidgeBars;
  int tohokuBars;

  // do we need final keyword?
  //final float[] scottData = { 0.33333334, 0.29113925, 0.17721519, 0.19831224, 0.18565401, 0.17299578, 0.22362868, 0.23206751, 0.25738397, 0.33333334, 0.4008439, 0.6118143, 0.8101266, 0.8101266, 0.8565401, 0.9704641, 0.9746835, 0.9409283, 0.87763715, 0.8101266, 0.721519, 0.814346, 0.814346, 0.7172996, 0.65400845, 0.65400845, 0.6329114, 0.60337555, 0.5527426, 0.42194092, 0.38396624, 0.35443038, 0.33333334, 0.32489452, 0.4177215, 0.4177215, 0.4177215, 0.36708862, 0.34177214, 0.4008439, 0.38818565, 0.45147678, 0.4599156, 0.38818565, 0.38818565, 0.34177214, 0.3164557, 0.31223628, 0.3206751, 0.3206751, 0.4599156, 0.46413502, 0.39240506, 0.32911393, 0.3206751, 0.35021096, 0.29113925, 0.21097046, 0.21097046, 0.21518987, 0.23206751, 0.2278481, 0.18565401, 0.14767933, 0.14767933, 0.16877638, 0.20675105, 0.21097046, 0.21097046, 0.1814346, 0.17721519, 0.17299578, 0.16877638, 0.15189873, 0.1392405, 0.1308017, 0.12658228, 0.10970464, 0.10548523, 0.101265825, 0.09704641, 0.09704641, 0.11392405, 0.18987341, 0.21518987, 0.21518987, 0.17299578, 0.1308017, 0.12236287, 0.12236287, 0.21097046, 0.21097046, 0.21097046, 0.14345992, 0.10970464, 0.09704641, 0.1308017, 0.16033755, 0.15189873, 0.11814346, 0.11814346, 0.12658228, 0.13502109, 0.11392405, 0.08438819, 0.06329114, 0.05907173, 0.07594936, 0.07594936, 0.07594936, 0.07594936, 0.07594936, 0.07172996, 0.07172996, 0.05907173, 0.05485232, 0.05485232, 0.050632913, 0.046413504, 0.042194095, 0.042194095, 0.03797468, 0.03797468, 0.03797468, 0.033755273, 0.029535865, 0.029535865, 0.021097047 }; //128 elements
  final float[] scottData = {0.059071727, 0.059071727, 0.059071727, 0.054852318, 0.054852318, 0.054852318, 0.059071727, 0.059071727, 0.059071727, 0.06329114, 0.067510545, 0.080168776, 0.088607594, 0.09282701, 0.10126582, 0.10548523, 0.10970464, 0.1308017, 0.1392405, 0.15189873, 0.16033755, 0.16455697, 0.16033755, 0.16033755, 0.16033755, 0.15611814, 0.15611814, 0.17299578, 0.1814346, 0.18987341, 0.18987341, 0.18565401, 0.18565401, 0.18565401, 0.18565401, 0.20675106, 0.21518987, 0.21518987, 0.21518987, 0.21518987, 0.20675106, 0.18987341, 0.18987341, 0.18565401, 0.1814346, 0.1814346, 0.17721519, 0.17721519, 0.17721519, 0.1814346, 0.18987341, 0.19409283, 0.20253165, 0.20675106, 0.21097046, 0.19409283, 0.17721519, 0.16877638, 0.16877638, 0.17299578, 0.18987341, 0.21518987, 0.23206751, 0.24472573, 0.25738397, 0.2742616, 0.29113925, 0.32489452, 0.35443038, 0.3586498, 0.35021096, 0.33333334, 0.3164557, 0.3164557, 0.31223628, 0.3206751, 0.3206751, 0.32911393, 0.33333334, 0.33755276, 0.35443038, 0.36708862, 0.38396624, 0.38818565, 0.38818565, 0.38818565, 0.38818565, 0.3586498, 0.30379748, 0.26582277, 0.23628692, 0.2278481, 0.2236287, 0.2236287, 0.24050634, 0.26160336, 0.25738397, 0.23628692, 0.21518987, 0.18987341, 0.17721519, 0.16033755, 0.14767933, 0.14767933, 0.1392405, 0.1392405, 0.10970464, 0.10126582, 0.09704641, 0.09704641, 0.088607594, 0.08438818, 0.07594936, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.05063291, 0.05063291, 0.05063291, 0.05063291, 0.054852318, 0.054852318, 0.05063291};


  // final float[] northRidgeData = {0.021097047, 0.021097047, 0.021097047, 0.021097047, 0.021097047, 0.025316456, 0.029535865, 0.029535865, 0.029535865, 0.029535865, 0.033755273, 0.03797468, 0.050632913, 0.05485232, 0.05485232, 0.05485232, 0.05485232, 0.05485232, 0.05485232, 0.067510545, 0.101265825, 0.14345992, 0.15611814, 0.15189873, 0.13502109, 0.12236287, 0.12236287, 0.16877638, 0.18565401, 0.2278481, 0.25738397, 0.28691983, 0.2616034, 0.24472573, 0.24050634, 0.2742616, 0.30379745, 0.32911393, 0.33755276, 0.3164557, 0.28691983, 0.20253165, 0.20253165, 0.22362868, 0.23628692, 0.20675105, 0.15611814, 0.19831224, 0.21097046, 0.20675105, 0.19831224, 0.17299578, 0.15611814, 0.2278481, 0.34599155, 0.38818565, 0.37130803, 0.33755276, 0.23206751, 0.25738397, 0.278481, 0.278481, 0.3206751, 0.34599155, 0.36708862, 0.3586498, 0.34177214, 0.32911393, 0.32911393, 0.45147678, 0.48523206, 0.5485232, 0.5611814, 0.556962, 0.5443038, 0.51476794, 0.2278481, 0.10548523, 0.08438819, 0.11814346, 0.15611814, 0.21097046, 0.23206751, 0.25316456, 0.35021096, 0.37130803, 0.34599155, 0.32911393, 0.32911393, 0.32911393, 0.33755276, 0.4050633, 0.59915614, 0.64978904, 0.65400845, 0.64978904, 0.60337555, 0.56540084, 0.5316456, 0.278481, 0.24050634, 0.14767933, 0.11814346, 0.12658228, 0.1392405, 0.20675105, 0.21097046, 0.20253165, 0.1814346, 0.16033755, 0.14345992, 0.19409283, 0.2278481, 0.23628692, 0.23628692, 0.23206751, 0.23628692, 0.3206751, 0.2742616, 0.21518987, 0.15611814, 0.10970464, 0.09704641, 0.09704641, 0.09282701, 0.09282701, 0.09282701, 0.088607594, 0.088607594, 0.088607594, 0.09704641, 0.12658228, 0.10970464, 0.09282701, 0.06329114, 0.05485232, 0.050632913, 0.042194095, 0.042194095, 0.03797468, 0.029535865, 0.033755273, 0.021097047, 0.0210};
  final float[] northRidgeData = {0.088607594, 0.088607594, 0.088607594, 0.088607594, 0.088607594, 0.092827, 0.09704641, 0.09704641, 0.09704641, 0.09704641, 0.10126582, 0.10548523, 0.118143454, 0.12236287, 0.12236287, 0.12236287, 0.12236287, 0.12236287, 0.12236287, 0.13502109, 0.16877636, 0.21097046, 0.22362868, 0.21940927, 0.20253164, 0.18987341, 0.18987341, 0.23628692, 0.25316456, 0.29535866, 0.33755273, 0.34177214, 0.33755273, 0.33333334, 0.33333334, 0.33333334, 0.34177214, 0.35443038, 0.3628692, 0.3755274, 0.371308, 0.3586498, 0.35021096, 0.34599155, 0.33333334, 0.3080169, 0.29535866, 0.29113925, 0.29957807, 0.32489452, 0.33755273, 0.33333334, 0.3206751, 0.31223628, 0.3080169, 0.32489452, 0.3586498, 0.3755274, 0.3755274, 0.3755274, 0.3755274, 0.3755274, 0.3755274, 0.39662448, 0.4135021, 0.42194092, 0.42616034, 0.43459916, 0.43881857, 0.43881857, 0.43881857, 0.4556962, 0.4556962, 0.46413502, 0.48101264, 0.48945147, 0.48945147, 0.48101264, 0.47257385, 0.44725737, 0.4177215, 0.40928268, 0.4050633, 0.4050633, 0.4050633, 0.4050633, 0.4050633, 0.42616034, 0.42616034, 0.42194092, 0.42194092, 0.42194092, 0.42194092, 0.4135021, 0.4050633, 0.39240506, 0.38396624, 0.37974682, 0.37974682, 0.3755274, 0.3628692, 0.34599155, 0.27004218, 0.14345992, 0.14345992, 0.101265825, 0.046413504, 0.042194095, 0.03797468, 0.033755273, 0.033755273, 0.016877636, 0.016877636, 0.016877636, 0.016877636, 0.016877636, 0.016877636, 0.016877636, 0.012658228, 0.012658228, 0.012658228, 0.012658228, 0.012658228, 0.012658228, 0.012658228, 0.016877636, 0.016877636, 0.012658228};


  //final float[] tohokuData = {0.016877636, 0.012658228, 0.025316456, 0.029535865, 0.029535865, 0.029535865, 0.029535865, 0.042194095, 0.05907173, 0.07172996, 0.08438819, 0.07594936, 0.101265825, 0.10970464, 0.15611814, 0.21097046, 0.29535866, 0.37974682, 0.51054853, 0.56540084, 0.5864979, 0.60337555, 0.51476794, 0.3586498, 0.31223628, 0.28691983, 0.33333334, 0.33755276, 0.21518987, 0.19409283, 0.19831224, 0.24472573, 0.2616034, 0.20675105, 0.16033755, 0.1392405, 0.101265825, 0.09282701, 0.10970464, 0.16033755, 0.20675105, 0.21097046, 0.19409283, 0.16455697, 0.16033755, 0.17721519, 0.31223628, 0.45147678, 0.47679326, 0.56540084, 0.6118143, 0.6455696, 0.6624473, 0.67932487, 0.8565401, 0.8649789, 0.8101266, 0.6835443, 0.6075949, 0.32489452, 0.278481, 0.30379745, 0.34599155, 0.3628692, 0.38396624, 0.38396624, 0.32489452, 0.23628692, 0.27004218, 0.30379745, 0.3206751, 0.33333334, 0.34177214, 0.32911393, 0.30801687, 0.25738397, 0.31223628, 0.32489452, 0.32489452, 0.31223628, 0.21518987, 0.18987341, 0.1814346, 0.16877638, 0.14767933, 0.12236287, 0.11392405, 0.10970464, 0.10548523, 0.11392405, 0.14345992, 0.15189873, 0.16033755, 0.16877638, 0.16033755, 0.16033755, 0.15611814, 0.15189873, 0.14767933, 0.1308017, 0.10548523, 0.088607594, 0.07594936, 0.07172996, 0.07172996, 0.07172996, 0.07172996, 0.07594936, 0.088607594, 0.101265825, 0.11814346, 0.12236287, 0.12236287, 0.11392405, 0.10970464, 0.10970464, 0.10970464, 0.09704641, 0.09704641, 0.09704641, 0.088607594, 0.080168776, 0.07172996, 0.06329114, 0.05907173, 0.050632913, 0.03797468, 0.03797468};
  final float[] tohokuData ={0.21097046, 0.20253165, 0.21097046, 0.21940929, 0.22362868, 0.24050634, 0.30379745, 0.34599155, 0.37130803, 0.38818565, 0.4008439, 0.4135021, 0.4177215, 0.42616034, 0.42616034, 0.42616034, 0.4092827, 0.39240506, 0.37130803, 0.34177214, 0.31223628, 0.31223628, 0.3164557, 0.3206751, 0.34177214, 0.39662448, 0.4556962, 0.48523206, 0.5232068, 0.5485232, 0.56540084, 0.57383966, 0.5864979, 0.6075949, 0.62025315, 0.6329114, 0.6455696, 0.65822786, 0.6666667, 0.6751055, 0.67932487, 0.67932487, 0.67932487, 0.6835443, 0.6835443, 0.6877637, 0.6877637, 0.6835443, 0.6751055, 0.65822786, 0.6455696, 0.62025315, 0.5907173, 0.5611814, 0.5485232, 0.5485232, 0.5527426, 0.5611814, 0.57383966, 0.5907173, 0.6118143, 0.62447256, 0.6455696, 0.6666667, 0.6835443, 0.71308017, 0.73839664, 0.7679325, 0.7721519, 0.7763713, 0.78902954, 0.8016878, 0.8101266, 0.8185654, 0.835443, 0.8649789, 0.89451474, 0.92827004, 0.9535865, 0.96202534, 0.96202534, 0.9662447, 0.9662447, 0.9662447, 0.95780593, 0.93248945, 0.9113924, 0.90295357, 0.87763715, 0.84388185, 0.8016878, 0.7763713, 0.75949365, 0.75949365, 0.75527424, 0.7510548, 0.7510548, 0.7510548, 0.75527424, 0.70886075, 0.6919831, 0.6919831, 0.6666667, 0.6455696, 0.5949367, 0.5780591, 0.5485232, 0.36708862, 0.34177214, 0.2616034, 0.14345992, 0.088607594, 0.088607594, 0.088607594, 0.088607594, 0.046413504, 0.03797468, 0.03797468, 0.03797468, 0.029535865, 0.025316456, 0.025316456, 0.025316456, 0.021097047, 0.016877636, 0.012658228, 0.012658228, 0.012658228};





  int scottTime;
  int tohokuTime;
  int northRidgeTime;
  int state;
  int animationState;

  SpringGraph scottGraph;
  SpringGraph tohokuGraph;
  SpringGraph northRidgeGraph;

  int animationTimer;
  int scottStartTime;
  int scottCompleteTime;
  int scottActivityStartTime;
  int scottFadeOutTime;

  int tohokuStartTime;
  int tohokuCompleteTime;
  int tohokuActivityStartTime;
  int tohokuActivityStartTime2;
  int tohokuFadeOutTime;

  int northRidgeStartTime;
  int northRidgeCompleteTime;
  int northRidgeActivityStartTime;
  int northRidgeFadeOutTime;

  Label label1;
  Label label2;
  Label label3;

  boolean rotateScreen;

  VisualizationWall() {
    // quakeDuration / maxQuakeDuration * maxBars
    // 43s / 60a * 128 = 92 bars
    
    scottBars = 128;
    northRidgeBars = 128;
    tohokuBars = 128;

    // time the graphi is displayed
    scottTime = 61000; 
    tohokuTime = 58100;
    northRidgeTime = 52700;
    state = 0; // 0 - attractor, 1 - Scott, 2 - NorthRidge, 3 - Tohoku
    animationState = 0; // o - waiting for start dealy, 1 - started drawing graph
    rotateScreen = true;

    scottGraph = new SpringGraph(scottBars, scottData, scottTime, 3); // 3 sets the colortype ornage
    
    northRidgeGraph = new SpringGraph(northRidgeBars, northRidgeData, northRidgeTime, 1); // 1 blue
    tohokuGraph = new SpringGraph(tohokuBars, tohokuData, tohokuTime, 2); //2  yellow

    // used for all 3
    animationTimer = 0;

    scottStartTime = 12000;
    scottActivityStartTime = 20000;
    scottFadeOutTime = 70000;
    scottCompleteTime = 73000;

    tohokuStartTime = 13500;
    tohokuActivityStartTime = 50000;//30000;
    tohokuActivityStartTime2 = 68000;//50000;
    tohokuFadeOutTime = 69000;//65000;
    tohokuCompleteTime = 71000;//70000;
   
    northRidgeStartTime = 14000;
    northRidgeActivityStartTime = 42000;
    northRidgeFadeOutTime = 54000;
    northRidgeCompleteTime = 54000;

    label1 = new Label(1); // 1 sets the color to orange
    label1.turnOff();
    label2 = new Label(2);
    label2.turnOff();
    label3 = new Label(3);
    label3.turnOff();
  }
  void draw() {
    /* * * * * * * * * * * * * * * * * * * * * */ 
    /* * * * * VISULIZATIONS WALL * * * * * * */
    /* * * * * * * * * * * * * * * * * * * * */ 
    // Move drawing origin to led Panel Start X Y locations
    // and rotate screen to allign with led Panels
    // translate(100, 100);
    pushMatrix();
    if (rotateScreen) {
      fill(100);
      text("Visualization Wall", 30, 540);
      translate(512,0);
      rotate(HALF_PI*3); 
      translate(-512,-512);
      
    } else {
      fill(100);
      text("Visualization Wall", 30, 180);
    }
    // drawDebugSections();

    
    if(state==0) {
      // * * * * * * * * * * * * * * * * * * * 
      // * * * * * * Atractor * * * * * * * * *
      // * * * * * * * * * * * * * * * * * * *
      label1.attractorOn();
      label2.attractorOn();
      label3.attractorOn();
    } else if (state==1) {
      // * * * * * * * * * * * * * * * * * * * 
      // * * * * * * Scott Mills * * * * * * *
      // * * * * * * * * * * * * * * * * * * * 
      // if delayTime passed draw
      
      if(animationState == 0) {
        // start the graph
        if(millis() - animationTimer > scottStartTime) {
        scottGraph.reset();
        animationState = 1;
        }
      } else if (animationState == 1){
        if(millis() - animationTimer > scottActivityStartTime) {
          //activity wall Animation starts
          animationState = 2;
        }
        scottGraph.update();
        scottGraph.draw();
      } else if (animationState == 2){
        if(millis() - animationTimer > scottFadeOutTime) {
          //fade out graph
          //fade out label
          label1.fadeOut();
          animationState = 3;
        }
        scottGraph.update();
        scottGraph.draw();
      } else if (animationState == 3){
        if(millis() - animationTimer > scottCompleteTime) {
          // return to the attracktor
          state = 0;
          animationState = 0;
        }
        scottGraph.update();
        scottGraph.draw();
      }

    
    } else if (state == 2) {
      // * * * * * * * * * * * * * * * * * * * 
      // * * * * * * North Ridge * * * * * * *
      // * * * * * * * * * * * * * * * * * * * 
      if(animationState == 0) {
        // start the graph
        if(millis() - animationTimer > northRidgeStartTime) {
        northRidgeGraph.reset();
        animationState = 1;
        }
      } else if (animationState == 1){
        if(millis() - animationTimer > northRidgeActivityStartTime) {
          //activity wall Animation starts
          animationState = 2;
        }
        northRidgeGraph.update();
        northRidgeGraph.draw();
      } else if (animationState == 2){
        if(millis() - animationTimer > northRidgeFadeOutTime) {
          //fade out graph
          //fade out label
          label2.fadeOut();
          animationState = 3;
        }
        northRidgeGraph.update();
        northRidgeGraph.draw();
      } else if (animationState == 3){
        if(millis() - animationTimer > northRidgeCompleteTime) {
          // return to the attracktor
          state = 0;
          animationState = 0;
        }
        // northRidgeGraph.update();
        // northRidgeGraph.draw();
      }
      
     } else if (state == 3) {
      // * * * * * * * * * * * * * * * * * * * 
      // * * * * * * * Tohoku * * * * * * * * *
      // * * * * * * * * * * * * * * * * * * * 
      if(animationState == 0) {
        // start the graph
        if(millis() - animationTimer > tohokuStartTime) {
        tohokuGraph.reset();
        animationState = 1;
        }
      } else if (animationState == 1){
        if(millis() - animationTimer > tohokuActivityStartTime) {
          //activity wall Animation starts
          animationState = 2;
        }
        tohokuGraph.update();
        tohokuGraph.draw();
      } else if (animationState == 2){
        if(millis() - animationTimer > tohokuFadeOutTime) {
          //fade out graph
          //fade out label
          label3.fadeOut();
          animationState = 3;
        }
        tohokuGraph.update();
        tohokuGraph.draw();
      } else if (animationState == 3){
        if(millis() - animationTimer > tohokuCompleteTime) {
          // return to the attracktor
          state = 0;
          animationState = 0;
        }
        // fade out graph 5secs
        // tohokuGraph.update();
        // tohokuGraph.draw();
      }
      }

    
    pushMatrix();
    //translate(1, 9); // old code
    translate(-1, -16); // move to section 1
    label1.draw();
    translate(170, 0); // move to section 2
    label2.draw();
    translate(170, 0); // move to section 3
    label3.draw();
    popMatrix();

    popMatrix(); // end rotation
    
    
  } // end draw()
  void toggleRotation() {
    rotateScreen = !rotateScreen;
  }
  void turnOffLabels() {
    label1.turnOff();
    label2.turnOff();
    label3.turnOff();
  }
  void resetTimers() {
    animationTimer = millis();
  }
  void setState(int _state) {
    // start a quake animation
    state = _state;
    animationState = 0;
    if(state == 1) { 
      scottGraph.reset();
      resetTimers();
      turnOffLabels();
      label1.fadeIn();
    } else if(state == 2) {
      northRidgeGraph.reset();
      resetTimers();
      turnOffLabels();
      label2.fadeIn();
    } else if(state == 3) {
      tohokuGraph.reset();
      resetTimers();
      turnOffLabels();
      label3.fadeIn();
    } else if (state == 0) {
      label1.turnOff();
      label2.turnOff();
      label3.turnOff();
    }
    
  }
}
